<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8"/>
<title>Insert title here</title>
</head>
<body>
	<!-- modal alert archivage  -->
	<div class="modal fade" tabindex="-1" role="dialog" th:id="${id != null ? id : 'modal_justification'}" th:fragment="modal_justification">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header bg-info text-light">
					<h5 class="modal-title">Justifications du proccess {{selectedProcess.label}}</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close" data-ng-click="closeModal();">
						<span aria-hidden="true" data-ng-click="closeModal();">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="row" data-ng-if="withEdit == true">
						<div class="col-sm-12 text-right">
							<i class="cursor-pointer fa fa-eye-slash text-info fa-lg boder-right mr-2 pr-1"
							 title="cacher le formulaire" data-ng-click="hideEditJustificationForm();"></i>
							<span class="cursor-pointer badge badge-warning" title="Reinitialiser le formulaire"
							 data-ng-click="resetEditJustificationForm();">Reinitialiser</span>
						</div>
					   <div data-ng-if="$parent.errorMsg" class="col-sm-12">
							<div class="text-center" th:replace="fragments/alert::flash-danger(body='{{$parent.errorMsg}}',id='errorJustifylert')"></div>
						</div>
						<div data-ng-if="$parent.successMsg" class="col-sm-12"> 
							<div class="text-center" th:replace="fragments/alert::flash-success(body='{{$parent.successMsg}}',id='successJustifyAlert')"></div>
						</div>
						<input type="hidden" data-ng-model="$parent.jid"/>
						<input type="hidden" data-ng-model="$parent.tid"/>
						<div class="form-group col-sm-12 col-md-6">
							<label class="control-label" for="impact">Impact : </label>
							<select class="form-control form-control-sm" data-ng-model="$parent.impact" id="impact">
								<option data-ng-repeat="im in impacts" value="{{im.slug}}">{{im.name}}</option>
							</select>
						</div>
						<div class="form-group col-sm-12 col-md-6">
							<label class="control-label" for="cause">Cause : </label>
							<select class="form-control form-control-sm" data-ng-model="$parent.cause" id="cause" readOnly>
								<option value="finished_expired">Process traité tardivement</option>
								<option value="unfinished_expired">Process non traité et delaie expiré</option>
								<option value="process_canceld">Process annulé</option>
								<option value="unlunched">Process non démarré</option>
						       <option value="valid">Tâche en traitement</option>
						       <option value="t_canceled">Tâche annulée</option>
						       <option value="completed">Tâche traité</option>
							</select>
						</div>
						<div class="form-group col-sm-12">
							<label class="control-label" for="content">Contenu : </label>
							<textarea rows="3" cols=""  class="form-control form-control-sm"
							         placeholder="Tappez le text de justification ici" data-ng-model="$parent.content" id="content"></textarea>
						</div>
						<div class="form-group col-sm-12 col-md-12">
							<button class="btn btn-sm btn-outline-info float-right" data-ng-click="editJustification();">Valider</button>
						</div>
					</div>
					<!--  row show justifications -->
					<div class="row no-gotters" data-ng-if="selectedJustification != null && withEdit == false">
						<div class="col-sm-12 col-md-6">
							<a href="#" class="text-decoration-none fa_table_link ml-2 border-right rounded pl-1 pr-1" 
								data-ng-repeat="justification in justifications"
								data-ng-class="{'bg-info text-white' : selectedJustification.id==justification.id}"
							 data-justificationIndex="{{$index}}" data-ng-click="changeSeletctedJustification($event);">{{$index +1}}</a>
						</div>
						<div class="col-sm-12 col-md-6 text-right">
							<i class="cursor-pointer fa_table_link fas fa-plus-circle border-right pr-1" title="Nouvelle justification"
							data-processId="{{selectedProcess.id}}" data-taskId="{{selectedTask.id}}" data-ng-click="showModalEditJustificationWithNewForm($event)"></i>
							<i class="cursor-pointer fa_table_link fas fa-edit" title="Modifier la justification"
							data-processId="{{selectedProcess.id}}" data-taskId="{{selectedTask.id}}" data-ng-click="showModalEditJustificationWithEditForm($event)"></i>
						</div>
						<div class="col-sm-12 mt-2">
							<div class="card m-0 p-0">
								<div class="card-header bg-white border-0">
									<div class="row">
										<div class="col-sm-12 col-md-6 border-right-secondary"><span class="badge badge-default text-info">Impact </span>: <span class="badge badge-default">{{ selectedJustification.impact.name}}</span></div>
										<div class="col-sm-12 col-md-6 text-right"><span class="badge badge-default text-info">Cause</span> : <span class="badge badge-default">{{ selectedJustification.translatedCause}}</span></div>
										<div data-ng-if="selectedTask != null" class="col-sm-12 text-center"><span class="badge badge-default text-info">Tâche</span> : <span class="badge badge-default">{{ selectedTask.name}}</span></div>
									</div>
								</div>
						       <div class="card-body border-top text-center">
							       	<h5 class=""><span class="badge badge-default text-info border-bottom">Justification</span></h5>
							       	<p> {{ selectedJustification.content}}</p>
						       	</div>
							</div>
						 </div>
					</div>
				</div>
				<div class="modal-footer">
		        	<button type="button" class="btn btn-secondary" data-dismiss="modal" data-ng-click="closeModal();">Fermer</button>
		        </div>
			</div>
		</div>
	</div>
</body>
</html>